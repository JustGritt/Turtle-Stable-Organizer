---
import Gallery from '@icons/gallery.astro';
import Question from '@icons/Question.astro';
import Prompt from '@icons/prompt.astro';
---

<section class="min-h-[full] mt-4 p-4 bg-white border border-gray-200 rounded-lg shadow-sm dark:border-gray-700 sm:p-6 dark:bg-gray-800">
    <div class="flex items-center justify-center w-full">
        <label for="dropzone-file" class="flex flex-col items-center justify-center w-full h-full max-h-[600px] border-2 border-gray-300 border-dashed rounded-lg cursor-pointer bg-gray-50 dark:hover:bg-bray-800 dark:bg-gray-700 hover:bg-gray-100 dark:border-gray-600 dark:hover:border-gray-500 dark:hover:bg-gray-600 overflow-hidden">
            <div id="dropzone-content" class="flex flex-col items-center justify-center pt-5 pb-6">
                <Gallery class="w-12 h-12 text-gray-400 dark:text-gray-500" />
                <p class="my-2 text-md text-gray-500 dark:text-gray-400">
                    <span class="font-semibold">Click to upload</span> or drag and drop
                </p>
                <p class="text-xs text-gray-500 dark:text-gray-400">PNG, JPEG or JPG</p>
            </div>
            <input id="dropzone-file" type="file" class="hidden" accept="png, jpg, jpeg" />
        </label>
    </div>
</section>

<!-- TODO: Replace by EXIF metadata -->
<section class="min-h-[full] mt-4 p-4 bg-white border border-gray-200 rounded-lg shadow-sm dark:border-gray-700 sm:p-6 dark:bg-gray-800">
    <section class="bg-white dark:bg-gray-900">
        <div class="py-8 px-4 mx-auto max-w-screen-xl sm:py-16 lg:px-6">
            <h2 class="mb-8 text-4xl tracking-tight font-extrabold text-gray-900 dark:text-white">EXIF Informations</h2>
            <div class="mb-10">
                <h3 class="flex items-center mb-4 text-lg font-medium text-gray-900 dark:text-white">
                    <Prompt />
                    <span class="ml-2">Prompt</span>
                </h3>
                <textarea id="prompt" rows="4" class="block p-2.5 w-full text-sm text-gray-900 bg-gray-50 rounded-lg border border-gray-300 focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-blue-500 dark:focus:border-blue-500"></textarea>
            </div>
            <div class="mb-10">
                <h3 class="flex items-center mb-4 text-lg font-medium text-gray-900 dark:text-white">
                    <Prompt />
                    <span class="ml-2">Negative</span>
                </h3>
                <textarea id="prompt" rows="4" class="block p-2.5 w-full text-sm text-gray-900 bg-gray-50 rounded-lg border border-gray-300 focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-blue-500 dark:focus:border-blue-500"></textarea>
            </div>
            <div class="grid pt-8 text-left border-t border-gray-200 md:gap-16 dark:border-gray-700 grid-cols-3">
                <div>
                    <div class="mb-10">
                        <h3 class="flex items-center mb-4 text-lg font-medium text-gray-900 dark:text-white">
                            <Question />
                            Sampler
                        </h3>
                        <p class="text-gray-500 dark:text-gray-400">DPM++ 2M Karras</p>
                    </div>
                    <div class="mb-10">
                        <h3 class="flex items-center mb-4 text-lg font-medium text-gray-900 dark:text-white">
                            <Question />
                            Seed
                        </h3>
                        <p class="text-gray-500 dark:text-gray-400">1998319159</p>
                    </div>
                </div>
                <div>
                    <div class="mb-10">
                        <h3 class="flex items-center mb-4 text-lg font-medium text-gray-900 dark:text-white">
                            <Question />
                            CFG scale
                        </h3>
                        <p class="text-gray-500 dark:text-gray-400">7</p>
                    </div>
                    <div class="mb-10">
                        <h3 class="flex items-center mb-4 text-lg font-medium text-gray-900 dark:text-white">
                            <Question />
                            Size
                        </h3>
                        <p class="text-gray-500 dark:text-gray-400">1024 x 1024</p>
                    </div>
                </div>
                <div>
                    <div class="mb-10">
                        <h3 class="flex items-center mb-4 text-lg font-medium text-gray-900 dark:text-white">
                            <Question />
                            Steps
                        </h3>
                        <p class="text-gray-500 dark:text-gray-400">30</p>
                    </div>
                    <div class="mb-10">
                        <h3 class="flex items-center mb-4 text-lg font-medium text-gray-900 dark:text-white">
                            <Question />
                            Model
                        </h3>
                        <p class="text-gray-500 dark:text-gray-400"></p>
                    </div>
                </div>
            </div>
        </div>
    </section>
</section>

<script>
    const dropzone = document.getElementById('dropzone-file');
    const dropzoneContent = document.getElementById('dropzone-content');

    // Handle file upload
    dropzone?.addEventListener('change', async (e) => {
        const files = (e.target as HTMLInputElement)?.files;
        if (!files) return;

        const img = document.createElement('img');
        img.src = URL.createObjectURL(files[0]);
        img.className = "w-full h-auto max-h-[600px] object-contain rounded-lg";

        dropzoneContent.innerHTML = '';
        dropzoneContent.appendChild(img);
    });
</script>